# 02장: URL과 리소스

리소스를 분류하기 위해 모든 것이 그만의 표준화된 이름을 가진다.
각기 다른 이름들에 대한 표준에 동의하기 때문에 리소스를 쉽게 공유할 수 있다.

URL은 인터넷의 리소스를 가리키는 표준 이름이다.
전자 정보 일부를 가리키고 그것이 어디있고 어떻게 접근 할 수 있는지 알려 준다.

‌

## 1) 인터넷 리소스 탐색

- url
    - 일반적인 구조: `스킴://서버위치/경로`
        - 스킴(어떻게): mailto(이메일), ftp(file), rtsp(비디오)
        - 서버위치(어디에): 호스팅
        - 경로(무엇을)
    - 인터넷상의 모든 리소스를 가리키고 가져오기위해 모든 사람이 같은 방식으로 이름을 써서 리소스를 찾을 수 있도록 단일 방식의 작명 규칙을 가진다.
    - application이 리소스에 접근할 수 있는 방법 제공
- URL은 '나'와 '브라우저'에게 정보를 찾는데 **필요한 모든 것을 제공**하고, 내가 원하는 리소스가 어디에 있고 어떻게 가져오는지 정의한다.

‌

## 2) URL 문법‌

- URL 스킴에 따라 문법이 다르지만, 대부분 일반적인 url 문법을 따른다.
URL 스킴의 문법은 일반적으로 9개 부분으로 나뉜다. 
하지만 이 모든 컴포넌트를 가지는 URL은 거의 없다. 
그 중 가장 중요한 3가지 컴포넌트는 **스킴, 호스트, 경로**다.

    ```markdown
    <스킴>://사용자이름:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<플래그먼트>
    ```

    ![1](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F9f1fa4c9-bf62-4389-af04-8d7328edb76f%2F01.jpeg?table=block&id=e494584e-fd9c-4b74-ae41-486afd8ffae3&spaceId=da06fe4c-dbc0-451e-a09d-8fe561a808ae&width=6340&userId=&cache=v2)

    출처: [https://feel5ny.github.io/2019/08/09/HTTP_002/#1-5](https://feel5ny.github.io/2019/08/09/HTTP_002/#1-5)

    - **스킴(구분자 `:`):** 리소스를 가져올 때 어떤 프로토콜을 사용하여 어떻게 서버에 접근할지 알려주는 정보.
    - **사용자 정보(구분자 `@`)**
        - **사용자이름**: 몇몇 스킴은 리소스 접근을 위해 사용자 이름을 필요로 한다. (기본값: anonymous)
        - **비밀번호**: 사용자의 비밀번호를 가리키고 사용자 이름에 콜론(`:`)으로 이어 기술 
        (기본값: email 주소, IE: `IEUser`, Chrome: `chrome@example.com`)
    - **호스트:**
        - **호스트명**: 리소스가 어디에 호스팅되어 있는지 알려준다. (서버 위치, 서버의 (호스트)명, IP 주소)
        - **포트**: 서버가 열어놓은 네트워크 포트 (기본값: TCP 프로토콜 사용하는 http 기본포트:80)
    - **경로**: 이전 컴포넌트와 빗금(`/`) 으로 구분. 서버 내 리소스가 어디에 있는지 가르키며, 문법은 서버와 스킴따라 상이.
    - **파라미터**: 
      많은 스킴이 호스트 및 경로 정보만으로 리소스를 찾지 못한다. (더 많은 정보가 필요할 수 있다.)
      특정 스킴들에서 입력 파라미터 기술 하는 용도. **이름/값 쌍**을 가짐. 세미콜론 (`;`)으로 다른 파라미터, 경로 구분할 수 있고 여러개 가질 수 있다. (리소스에 접근하는데 필요한 어떤 추가 정보든 전달.)
    - **질의**: 
      DB 와 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해 질의(질문)을 받을 수 있다.
      스킴에서 어플리케이션에 파라미터를 전달하는데 쓰인다. (`?`)우측에 붙여 전달 (`&`) 로 나누고 `이름=값` 형태
    - **플래그먼트**: 
      HTML 같은 리소스 형식 본래 수준보다 더 작게 나눌 수 있다.
      일반적으로 HTTP 서버는 객체 일부가 아닌 전체를 다루기 때문에, 클라이언트는 서버에 플래그먼트를 전달하지 않는다. 서버로부터 리소스를 내려받은 후, 플래그먼트를 사용해서 보고자 하는 리소스의 일부를 보여준다.
      리소스의 조각이나 일부분. 리소스의 특정 부분을 가리킬 수 있도록 하며, 클라이언트에서 서버로 전달 X.

    ## 3) 단축 URL

    웹 클라이언트는 몇몇 단축 URL 을 인식하고 사용한다.

    1. 상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있다.
    2. 'URL자동 확장': 사용자가 기억하고 있는 URL 일부를 입력하면 나머지 부분을 자동 입력

    ### ① 상대 URL

    - 절대url: 리소스에 접근하는데 필요한 모든 정보를 가지고 있다.
    - 상대url: 기저(base)라고 하는 다른 url을 사용해야 한다.
      기저 url 을 통해 상대 url에 기술하지 않은 정보를 추측할 수 있다. 
      브라우저 같은 어플리케이션은 상대 url과 절대 url 간에 상호 변환을 할 수 있어야 한다.

    기저 URL 찾는 방법

    1. 리소스에서 명시적으로 제공하는 `<base>` HTML 태그를 기술할 수 있다.
    2. 리소스를 포함하고 있는 기저 URL해당 리소스의 URL을 기저 URL로 쓸 수 있다.
    3. 기저URL이 없는 경우불안전하거나 깨진 URL일 수도 있다.

    상대 참조 해석하기

    상대 URL ⇒ 절대 URL로 변환하기 위한 다음 단계는 
    상대 URL, base URL을 각각 컴포넌트 조각으로 나누는 것이다. 
    (URL 파싱, URL 분해하기) 

    분해 후, 변환을 끝내기 위해 다음 알고리즘을 사용한다.(상대 ⇒ 절대 url)

    ![2](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fdaae0d7a-0c8a-4db6-8124-510a72a11f35%2F02.jpeg?table=block&id=a711580c-28d3-416c-8bd4-eff971a3f819&spaceId=da06fe4c-dbc0-451e-a09d-8fe561a808ae&width=2310&userId=&cache=v2)

    ### ② URL 확장

    1. 호스트명 확장: 단순한 휴리스틱만을 사용해서 입력한 호스트명을 전체 호스트명으로 확장.
      (예: yahoo 입력시 ⇒ www.yahoo.com. 해당 단어를 찾지 못하면 비슷한 url 추가 제시)
    2. 히스토리 확장: 과거에 사용자가 방문했던 URL 기록 저장.

    단, 프록시 사용시 다른 HTTP 애플리케이션에 문제를 발생할 수 있다.

    ## 4) 안전하지 않은 문자

    URL 설계자들은 모든 인터넷 프로토콜로 URL이 안전하게 전송될 수 있길 바라면서 가독성도 있기를 바란다.

    안전한 전송이란, 정보가 유실될 위험 없이 URL을 전송할 수 있다는 의미.

    또한 이전 데이터나 일반적으로 안전한 알파벳 외의 문자도 포함하려할때가 있다는 점을 통해 안전한 문자로 인코딩하도록 하였다.

    URL 에서 사용가능한 알파벳과 URL 의 인코딩 규칙 요약. 

    ### ① URL 문자집합

    - 컴퓨터 시스템의 기본 문자집합은 보통 영어 중심.
    - 역사적으로 US-ASCII문자 집합을 사용해왔었는데, 비교적 오래된 문자 집합이라 전세계 사람들이 사용하는 언어나 비 라틴계 언어들에 존재하는 변형문자를 지원해주지 않았다.
    - URL에 특정 이진데이터를 포함해야하는 경우도 있었다.
    - 그래서 URL 설계자들은 escape 문자열을 쓸 수 있도록 설계했다. escape 문자열이란, URL에서 사용 금지된 문자들로 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성, 완성도를 높혔다.

    ### ② 인코딩(Encoding) 체계

    - 안전하지 않은 문자를 `%` 로 시작해, ASCII 코드로 표현되는 두개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꾼다.

    ### ③ 문자 제한

    - 몇몇 문자는 url 내에서 특별한 의미로 예약되어 있다. 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면 그 전에 인코딩해야하는 문자들이 있다.

    ## 5) 미래

    - URL은 강력한 도구다. 세상에 존재하는 모든 객체에 이름을 지을 수 있고 새로운 포맷 추가도 가능하다. 또한 프로토콜간에 공유할 수 있는 일관된 작명 규칙을 제공한다.
    - 하지만, 완벽한게 아니다. (실제 이름이 아니라, 특정 시점에 어떤 것이 위치한 곳을 알려주는 것이다.)
    - 따라서 리소스 위치가 옮겨지면 더이상 해당 url은 사용불가.
    - URN처럼 항상 특정 객체를 가리킬 수 있는 이름을 제공하는 방법도 있으나, 표준화되지 않았음.
    - URL을 대체할 수 있는 작명 스킴이 나오기 전까지는 계속 사용될 것이다. 해결 가능한 새로운 표준이 나오게 된다면 적용될 수 있을 것.

  ---

    그림 참조: [https://feel5ny.github.io/2019/08/09/HTTP_002/](https://feel5ny.github.io/2019/08/09/HTTP_002/)